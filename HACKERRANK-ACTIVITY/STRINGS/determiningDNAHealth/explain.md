First reading all genes and their health values, then building a fast-lookup structure called gMap, where each unique gene stores the list of indices where it appears and a prefix-sum array that allows quick calculation of total health within any index range. At the same time, all possible prefix substrings of the genes are stored in a Set called subs, which is used to quickly check whether a growing substring of the DNA strand can still match a gene; if not, the inner loop breaks early for efficiency. For each DNA strand query, the function getHealth scans every starting position in the strand and extends outward character by character, forming substrings; whenever a substring matches a known gene, it uses binary search (bisect_left and bisect_right) to find which gene occurrences fall within the given first and last bounds, and uses the prefix-sum array to get their total health instantly. It accumulates this into the strand's total health, updating the global minimum and maximum values. Finally, after processing all strands, the program outputs the smallest and largest health values found.